<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>手摸手教你写个ESLint插件以及了解ESLint的运行原理 | 前端进阶积累</title>
    <meta name="description" content="种一棵树最好的时间是十年前，其次就是现在。">
    
    
    <link rel="preload" href="/web_accumulate/assets/css/0.styles.d1c73316.css" as="style"><link rel="preload" href="/web_accumulate/assets/js/app.5a5b14ca.js" as="script"><link rel="preload" href="/web_accumulate/assets/js/37.f9716a71.js" as="script"><link rel="preload" href="/web_accumulate/assets/js/2.58d0c891.js" as="script"><link rel="prefetch" href="/web_accumulate/assets/js/10.08a77354.js"><link rel="prefetch" href="/web_accumulate/assets/js/100.d47bfa44.js"><link rel="prefetch" href="/web_accumulate/assets/js/101.c2eb7956.js"><link rel="prefetch" href="/web_accumulate/assets/js/102.ed44c42e.js"><link rel="prefetch" href="/web_accumulate/assets/js/103.31810528.js"><link rel="prefetch" href="/web_accumulate/assets/js/104.558890d9.js"><link rel="prefetch" href="/web_accumulate/assets/js/105.f79f90b0.js"><link rel="prefetch" href="/web_accumulate/assets/js/106.277ec115.js"><link rel="prefetch" href="/web_accumulate/assets/js/107.0dca9b72.js"><link rel="prefetch" href="/web_accumulate/assets/js/108.c83893ff.js"><link rel="prefetch" href="/web_accumulate/assets/js/109.43128feb.js"><link rel="prefetch" href="/web_accumulate/assets/js/11.3208b498.js"><link rel="prefetch" href="/web_accumulate/assets/js/110.132c0b97.js"><link rel="prefetch" href="/web_accumulate/assets/js/12.f66076df.js"><link rel="prefetch" href="/web_accumulate/assets/js/13.4c19dff8.js"><link rel="prefetch" href="/web_accumulate/assets/js/14.64f83ae9.js"><link rel="prefetch" href="/web_accumulate/assets/js/15.c4baee77.js"><link rel="prefetch" href="/web_accumulate/assets/js/16.3752c3d1.js"><link rel="prefetch" href="/web_accumulate/assets/js/17.0e879842.js"><link rel="prefetch" href="/web_accumulate/assets/js/18.0c747737.js"><link rel="prefetch" href="/web_accumulate/assets/js/19.ba2ba33b.js"><link rel="prefetch" href="/web_accumulate/assets/js/20.8866a5b0.js"><link rel="prefetch" href="/web_accumulate/assets/js/21.3e436330.js"><link rel="prefetch" href="/web_accumulate/assets/js/22.f875cfc4.js"><link rel="prefetch" href="/web_accumulate/assets/js/23.75610fbd.js"><link rel="prefetch" href="/web_accumulate/assets/js/24.8ca94775.js"><link rel="prefetch" href="/web_accumulate/assets/js/25.af5f300f.js"><link rel="prefetch" href="/web_accumulate/assets/js/26.9065bc61.js"><link rel="prefetch" href="/web_accumulate/assets/js/27.1bc08b4c.js"><link rel="prefetch" href="/web_accumulate/assets/js/28.c140599a.js"><link rel="prefetch" href="/web_accumulate/assets/js/29.21075092.js"><link rel="prefetch" href="/web_accumulate/assets/js/3.44a6fc94.js"><link rel="prefetch" href="/web_accumulate/assets/js/30.bc42eed9.js"><link rel="prefetch" href="/web_accumulate/assets/js/31.2d887e81.js"><link rel="prefetch" href="/web_accumulate/assets/js/32.eba11626.js"><link rel="prefetch" href="/web_accumulate/assets/js/33.8f576fe8.js"><link rel="prefetch" href="/web_accumulate/assets/js/34.1085532b.js"><link rel="prefetch" href="/web_accumulate/assets/js/35.89b25567.js"><link rel="prefetch" href="/web_accumulate/assets/js/36.cbe07038.js"><link rel="prefetch" href="/web_accumulate/assets/js/38.5c2af814.js"><link rel="prefetch" href="/web_accumulate/assets/js/39.48f57a5f.js"><link rel="prefetch" href="/web_accumulate/assets/js/4.2f37e018.js"><link rel="prefetch" href="/web_accumulate/assets/js/40.47787d9b.js"><link rel="prefetch" href="/web_accumulate/assets/js/41.4bec427d.js"><link rel="prefetch" href="/web_accumulate/assets/js/42.28d686d6.js"><link rel="prefetch" href="/web_accumulate/assets/js/43.2fc0dc05.js"><link rel="prefetch" href="/web_accumulate/assets/js/44.e61528e8.js"><link rel="prefetch" href="/web_accumulate/assets/js/45.d16a2d60.js"><link rel="prefetch" href="/web_accumulate/assets/js/46.14d083f6.js"><link rel="prefetch" href="/web_accumulate/assets/js/47.bf6895de.js"><link rel="prefetch" href="/web_accumulate/assets/js/48.86be20c9.js"><link rel="prefetch" href="/web_accumulate/assets/js/49.9df9759e.js"><link rel="prefetch" href="/web_accumulate/assets/js/5.898d4a7e.js"><link rel="prefetch" href="/web_accumulate/assets/js/50.7c785c69.js"><link rel="prefetch" href="/web_accumulate/assets/js/51.94126382.js"><link rel="prefetch" href="/web_accumulate/assets/js/52.a6d92d5c.js"><link rel="prefetch" href="/web_accumulate/assets/js/53.1cb12405.js"><link rel="prefetch" href="/web_accumulate/assets/js/54.3752c9f4.js"><link rel="prefetch" href="/web_accumulate/assets/js/55.f880002a.js"><link rel="prefetch" href="/web_accumulate/assets/js/56.3d715eee.js"><link rel="prefetch" href="/web_accumulate/assets/js/57.411a3e9e.js"><link rel="prefetch" href="/web_accumulate/assets/js/58.6d9f404f.js"><link rel="prefetch" href="/web_accumulate/assets/js/59.ae62aa19.js"><link rel="prefetch" href="/web_accumulate/assets/js/6.42f36685.js"><link rel="prefetch" href="/web_accumulate/assets/js/60.aa302714.js"><link rel="prefetch" href="/web_accumulate/assets/js/61.613d626d.js"><link rel="prefetch" href="/web_accumulate/assets/js/62.424dd484.js"><link rel="prefetch" href="/web_accumulate/assets/js/63.70f76c79.js"><link rel="prefetch" href="/web_accumulate/assets/js/64.7d5941c4.js"><link rel="prefetch" href="/web_accumulate/assets/js/65.0adafdb4.js"><link rel="prefetch" href="/web_accumulate/assets/js/66.26227319.js"><link rel="prefetch" href="/web_accumulate/assets/js/67.8a8dd771.js"><link rel="prefetch" href="/web_accumulate/assets/js/68.15eb0f87.js"><link rel="prefetch" href="/web_accumulate/assets/js/69.5652083e.js"><link rel="prefetch" href="/web_accumulate/assets/js/7.41e100fb.js"><link rel="prefetch" href="/web_accumulate/assets/js/70.b10c106a.js"><link rel="prefetch" href="/web_accumulate/assets/js/71.015145a9.js"><link rel="prefetch" href="/web_accumulate/assets/js/72.2e1dac71.js"><link rel="prefetch" href="/web_accumulate/assets/js/73.f2b77bf3.js"><link rel="prefetch" href="/web_accumulate/assets/js/74.5e741f52.js"><link rel="prefetch" href="/web_accumulate/assets/js/75.f7413b35.js"><link rel="prefetch" href="/web_accumulate/assets/js/76.887e8bcf.js"><link rel="prefetch" href="/web_accumulate/assets/js/77.4cc49e96.js"><link rel="prefetch" href="/web_accumulate/assets/js/78.bb26efa2.js"><link rel="prefetch" href="/web_accumulate/assets/js/79.e9993c2c.js"><link rel="prefetch" href="/web_accumulate/assets/js/8.64162203.js"><link rel="prefetch" href="/web_accumulate/assets/js/80.c0124da5.js"><link rel="prefetch" href="/web_accumulate/assets/js/81.31fd692d.js"><link rel="prefetch" href="/web_accumulate/assets/js/82.8d87c8b3.js"><link rel="prefetch" href="/web_accumulate/assets/js/83.18e71cbb.js"><link rel="prefetch" href="/web_accumulate/assets/js/84.e1b7656a.js"><link rel="prefetch" href="/web_accumulate/assets/js/85.0514f26b.js"><link rel="prefetch" href="/web_accumulate/assets/js/86.b3fb3f58.js"><link rel="prefetch" href="/web_accumulate/assets/js/87.ff493a0b.js"><link rel="prefetch" href="/web_accumulate/assets/js/88.8df11a07.js"><link rel="prefetch" href="/web_accumulate/assets/js/89.d33d600c.js"><link rel="prefetch" href="/web_accumulate/assets/js/9.511fdd63.js"><link rel="prefetch" href="/web_accumulate/assets/js/90.8f55e1ba.js"><link rel="prefetch" href="/web_accumulate/assets/js/91.2a123073.js"><link rel="prefetch" href="/web_accumulate/assets/js/92.6a93947a.js"><link rel="prefetch" href="/web_accumulate/assets/js/93.576e923f.js"><link rel="prefetch" href="/web_accumulate/assets/js/94.05df0f4e.js"><link rel="prefetch" href="/web_accumulate/assets/js/95.4cb8baee.js"><link rel="prefetch" href="/web_accumulate/assets/js/96.08cd06a8.js"><link rel="prefetch" href="/web_accumulate/assets/js/97.972d4139.js"><link rel="prefetch" href="/web_accumulate/assets/js/98.5315c5fa.js"><link rel="prefetch" href="/web_accumulate/assets/js/99.0d0e030a.js">
    <link rel="stylesheet" href="/web_accumulate/assets/css/0.styles.d1c73316.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web_accumulate/" class="home-link router-link-active"><!----> <span class="site-name">前端进阶积累</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web_accumulate/accumulate/" class="nav-link router-link-active">前端积累</a></div><div class="nav-item"><a href="/web_accumulate/algorithm/" class="nav-link">前端算法</a></div><div class="nav-item"><a href="/web_accumulate/codeBlack/" class="nav-link">代码块</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/web_accumulate" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端进阶积累
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/web_accumulate" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开箱即用的代码块
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/Brush_algorithm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端算法
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/koro1FileHeader" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VsCode头部注释插件
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/markdown-img-down-site-change" target="_blank" rel="noopener noreferrer" class="nav-link external">
  一键替换markdown失效图片外链
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/notification-Koro1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  浏览器桌面通知npm包
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/web_accumulate/about.html" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web_accumulate/accumulate/" class="nav-link router-link-active">前端积累</a></div><div class="nav-item"><a href="/web_accumulate/algorithm/" class="nav-link">前端算法</a></div><div class="nav-item"><a href="/web_accumulate/codeBlack/" class="nav-link">代码块</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/web_accumulate" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端进阶积累
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/web_accumulate" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开箱即用的代码块
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/Brush_algorithm" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端算法
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/koro1FileHeader" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VsCode头部注释插件
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/markdown-img-down-site-change" target="_blank" rel="noopener noreferrer" class="nav-link external">
  一键替换markdown失效图片外链
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/OBKoro1/notification-Koro1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  浏览器桌面通知npm包
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/web_accumulate/about.html" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web_accumulate/accumulate/tool/ESLint插件.html" class="active sidebar-link">手摸手教你写个ESLint插件以及了解ESLint的运行原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#手摸手教你写个eslint插件以及了解eslint的运行原理" class="sidebar-link">手摸手教你写个ESLint插件以及了解ESLint的运行原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#插件目标" class="sidebar-link">插件目标</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#使用模板初始化项目：" class="sidebar-link">使用模板初始化项目：</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#ast——抽象语法树" class="sidebar-link">AST——抽象语法树</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#eslint的运行原理" class="sidebar-link">ESLint的运行原理</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#_1-将代码解析成ast" class="sidebar-link">1. 将代码解析成AST</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#_2-深度遍历ast，监听匹配过程。" class="sidebar-link">2. 深度遍历AST，监听匹配过程。</a></li></ul></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#开发规则" class="sidebar-link">开发规则</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#规则默认模板" class="sidebar-link">规则默认模板</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#create方法-监听选择器" class="sidebar-link">create方法-监听选择器</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#观察ast：" class="sidebar-link">观察AST：</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#rule完整文件" class="sidebar-link">rule完整文件</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#测试用例：" class="sidebar-link">测试用例：</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#在vscode中调试node文件" class="sidebar-link">在VSCode中调试node文件</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#运行测试用例进入断点" class="sidebar-link">运行测试用例进入断点</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#发布插件" class="sidebar-link">发布插件</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#集成到项目" class="sidebar-link">集成到项目:</a></li></ul></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#扩展：" class="sidebar-link">扩展：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#遍历方向：" class="sidebar-link">遍历方向：</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#fix函数：自动修复rule错误" class="sidebar-link">fix函数：自动修复rule错误</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#项目地址" class="sidebar-link">项目地址:</a></li><li class="sidebar-sub-header"><a href="/web_accumulate/accumulate/tool/ESLint插件.html#点个star支持我一下" class="sidebar-link">点个Star支持我一下~</a></li></ul></li></ul></li><li><a href="/web_accumulate/accumulate/JS/JS基础-继承.html" class="sidebar-link">JS基础-深入浅出继承</a></li><li><a href="/web_accumulate/accumulate/JS/prototype.html" class="sidebar-link">JS基础-原型、原型链</a></li><li><a href="/web_accumulate/accumulate/JS/JS基础-call和apply还有bind.html" class="sidebar-link">JS基础系列-重新认识call apply bind</a></li><li><a href="/web_accumulate/accumulate/tool/博客外链失效一键替换.html" class="sidebar-link">博客外链失效一键替换</a></li><li><a href="/web_accumulate/accumulate/tool/koroFileHeader.html" class="sidebar-link">koroFileHeader-VSCode文件头部注释生成</a></li><li><a href="/web_accumulate/accumulate/ES6/js调用栈机制与ES6尾调用优化介绍.html" class="sidebar-link">js 调用栈机制与ES6尾调用优化介绍</a></li><li><a href="/web_accumulate/accumulate/ES6/论普通函数和箭头函数的区别以及箭头函数的注意事项和不适用场景.html" class="sidebar-link">论普通函数和箭头函数的区别以及箭头函数的注意事项和不适用场景</a></li><li><a href="/web_accumulate/accumulate/JS/webWorker上手.html" class="sidebar-link">前端er来学习一下webWorker吧</a></li><li><a href="/web_accumulate/accumulate/JS/手摸手教你使用WebSocket.html" class="sidebar-link">手摸手教你使用WebSocket</a></li><li><a href="/web_accumulate/accumulate/JS/数组API解析合集.html" class="sidebar-link">数组API解析合集</a></li><li><a href="/web_accumulate/accumulate/tool/浏览器重绘重排.html" class="sidebar-link">轻松掌握浏览器重绘重排原理</a></li><li><a href="/web_accumulate/accumulate/tool/忍者秘籍定时器机制.html" class="sidebar-link">JS忍者秘籍中的定时器机制详解</a></li><li><a href="/web_accumulate/accumulate/tool/js事件循环机制.html" class="sidebar-link">事件循环(Event Loop)机制以及实例</a></li><li><a href="/web_accumulate/accumulate/tool/http缓存.html" class="sidebar-link">谈论HTTP缓存时我们在谈论什么</a></li><li><a href="/web_accumulate/accumulate/tool/js垃圾回收机制.html" class="sidebar-link">JS高程中的垃圾回收机制与常见内存泄露的解决方法</a></li><li><a href="/web_accumulate/accumulate/JS/Object.defineProperty.html" class="sidebar-link">一次弄懂 Object.defineProperty</a></li><li><a href="/web_accumulate/accumulate/Vue/极简双向绑定.html" class="sidebar-link">仿Vue极简双向绑定</a></li><li><a href="/web_accumulate/accumulate/Vue/vue钩子函数.html" class="sidebar-link">Vue的钩子函数[路由导航守卫、keep-alive、生命周期钩子]</a></li><li><a href="/web_accumulate/accumulate/effect/浏览器桌面通知.html" class="sidebar-link">H5 notification浏览器桌面通知</a></li><li><a href="/web_accumulate/accumulate/JS/函数防抖和函数节流.html" class="sidebar-link">防抖函数&amp;节流函数</a></li><li><a href="/web_accumulate/accumulate/ES6/let和const命令.html" class="sidebar-link">var和let/const的区别</a></li><li><a href="/web_accumulate/accumulate/effect/网页全屏.html" class="sidebar-link">全屏模式轻松掌握[局部元素全屏展示]</a></li><li><a href="/web_accumulate/accumulate/effect/复制粘贴系列.html" class="sidebar-link">前端er怎样操作复制粘贴</a></li><li><a href="/web_accumulate/accumulate/effect/退出页面发送请求.html" class="sidebar-link">Web sendBeacon 刷新/关闭页面之前发送请求</a></li><li><a href="/web_accumulate/accumulate/tool/Eslint自动修复格式错误.html" class="sidebar-link">VsCode保存时自动修复Eslint错误</a></li><li><a href="/web_accumulate/accumulate/tool/一份超级详细的Vue-cli3.0使用教程.html" class="sidebar-link">一份超级详细的Vue-cli3.0使用教程</a></li><li><a href="/web_accumulate/accumulate/amateur/VuePress文档.html" class="sidebar-link">如何搭建本文档</a></li><li><a href="/web_accumulate/accumulate/Vue/vue定义全局函数.html" class="sidebar-link">Vue 定义全局函数</a></li><li><a href="/web_accumulate/accumulate/Vue/弹窗.html" class="sidebar-link">简单的弹窗组件实现</a></li><li><a href="/web_accumulate/accumulate/effect/input的一些坑点分享.html" class="sidebar-link">input 的一些坑点分享</a></li><li><a href="/web_accumulate/accumulate/effect/前端弹幕效果实现思路.html" class="sidebar-link">前端弹幕效果实现思路</a></li><li><a href="/web_accumulate/accumulate/effect/时间差与时区转换.html" class="sidebar-link">计算两个时间的时间差&amp;时区转换</a></li><li><a href="/web_accumulate/accumulate/JS/cookie和storage的使用以及区别.html" class="sidebar-link">cookie、localStorage 和 sessionStorage 的使用以及区别</a></li><li><a href="/web_accumulate/accumulate/CSS/CSS概念-BFC深入浅出.html" class="sidebar-link">CSS 概念-BFC 深入浅出</a></li><li><a href="/web_accumulate/accumulate/CSS/CSS权重规则.html" class="sidebar-link">CSS 权重规则</a></li><li><a href="/web_accumulate/accumulate/amateur/高性能js.html" class="sidebar-link">[读书笔记]《高性能 JavaScript》</a></li><li><a href="/web_accumulate/accumulate/amateur/推箱子.html" class="sidebar-link">推箱子</a></li></ul> </div> <div class="page"> <div class="content"><h2 id="手摸手教你写个eslint插件以及了解eslint的运行原理"><a href="#手摸手教你写个eslint插件以及了解eslint的运行原理" aria-hidden="true" class="header-anchor">#</a> 手摸手教你写个ESLint插件以及了解ESLint的运行原理</h2> <p>这篇文章目的是介绍如何创建一个ESLint插件和创建一个<code>ESLint</code> <code>rule</code>，用以帮助我们更深入的理解ESLint的运行原理，并且在有必要时可以根据需求创建出一个完美满足自己需求的Lint规则。</p> <h3 id="插件目标"><a href="#插件目标" aria-hidden="true" class="header-anchor">#</a> 插件目标</h3> <p>禁止项目中<code>setTimeout</code>的第二个参数是数字。</p> <p>PS： 如果是数字的话，很容易就成为魔鬼数字，没有人知道为什么是这个数字, 这个数字有什么含义。</p> <h3 id="使用模板初始化项目："><a href="#使用模板初始化项目：" aria-hidden="true" class="header-anchor">#</a> 使用模板初始化项目：</h3> <h4 id="_1-安装npm包"><a href="#_1-安装npm包" aria-hidden="true" class="header-anchor">#</a> 1. 安装NPM包</h4> <p>ESLint官方为了方便开发者开发插件，提供了使用Yeoman模板(<code>generator-eslint</code>)。</p> <p>对于Yeoman我们只需知道它是一个脚手架工具，用于生成包含指定框架结构的工程化目录结构。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install <span class="token operator">-</span>g yo generator<span class="token operator">-</span>eslint
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-创建一个文件夹："><a href="#_2-创建一个文件夹：" aria-hidden="true" class="header-anchor">#</a> 2. 创建一个文件夹：</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mkdir eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>demo
cd eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>demo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-命令行初始化eslint插件的项目结构"><a href="#_3-命令行初始化eslint插件的项目结构" aria-hidden="true" class="header-anchor">#</a> 3. 命令行初始化ESLint插件的项目结构:</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>yo eslint<span class="token punctuation">:</span>plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面进入命令行交互流程，流程结束后生成ESLint插件项目框架和文件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">?</span> What is your name<span class="token operator">?</span> OBKoro1
<span class="token operator">?</span> What is the plugin <span class="token constant">ID</span><span class="token operator">?</span> korolint   <span class="token comment">// 这个插件的ID是什么</span>
<span class="token operator">?</span> Type a short description <span class="token keyword">of</span> <span class="token keyword">this</span> plugin<span class="token punctuation">:</span> <span class="token constant">XX</span>公司的定制ESLint rule <span class="token comment">// 输入这个插件的描述</span>
<span class="token operator">?</span> Does <span class="token keyword">this</span> plugin contain custom ESLint rules<span class="token operator">?</span> Yes <span class="token comment">// 这个插件包含自定义ESLint规则吗?</span>
<span class="token operator">?</span> Does <span class="token keyword">this</span> plugin contain one or more processors<span class="token operator">?</span> No <span class="token comment">// 这个插件包含一个或多个处理器吗</span>
<span class="token comment">// 处理器用于处理js以外的文件 比如.vue文件</span>
   create <span class="token keyword">package</span><span class="token punctuation">.</span>json
   create lib<span class="token operator">/</span>index<span class="token punctuation">.</span>js
   create <span class="token constant">README</span><span class="token punctuation">.</span>md
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>现在可以看到在文件夹内生成了一些文件夹和文件，但我们还需要创建规则具体细节的文件。</p> <h4 id="_4-创建规则"><a href="#_4-创建规则" aria-hidden="true" class="header-anchor">#</a> 4. 创建规则</h4> <blockquote><p>上一个命令行生成的是ESLint插件的项目模板，这个命令行是生成ESLint插件具体规则的文件。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>yo eslint<span class="token punctuation">:</span>rule <span class="token comment">// 生成 eslint rule的模板文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>创建规则命令行交互：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">?</span> What is your name<span class="token operator">?</span> OBKoro1
<span class="token operator">?</span> Where will <span class="token keyword">this</span> rule be published<span class="token operator">?</span> <span class="token punctuation">(</span>Use arrow keys<span class="token punctuation">)</span> <span class="token comment">// 这个规则将在哪里发布？</span>
❯ ESLint Core  <span class="token comment">// 官方核心规则 (目前有200多个规则)</span>
  ESLint Plugin  <span class="token comment">// 选择ESLint插件</span>
<span class="token operator">?</span> What is the rule <span class="token constant">ID</span><span class="token operator">?</span> settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number  <span class="token comment">// 规则的ID</span>
<span class="token operator">?</span> Type a short description <span class="token keyword">of</span> <span class="token keyword">this</span> rule<span class="token punctuation">:</span> setTimeout 第二个参数禁止是数字  <span class="token comment">// 输入该规则的描述</span>
<span class="token operator">?</span> Type a short example <span class="token keyword">of</span> the code that will fail<span class="token punctuation">:</span>  占位  <span class="token comment">// 输入一个失败例子的代码</span>
   create docs<span class="token operator">/</span>rules<span class="token operator">/</span>settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number<span class="token punctuation">.</span>md
   create lib<span class="token operator">/</span>rules<span class="token operator">/</span>settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number<span class="token punctuation">.</span>js
   create tests<span class="token operator">/</span>lib<span class="token operator">/</span>rules<span class="token operator">/</span>settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="加了具体规则文件的项目结构"><a href="#加了具体规则文件的项目结构" aria-hidden="true" class="header-anchor">#</a> 加了具体规则文件的项目结构</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">.</span>
├── <span class="token constant">README</span><span class="token punctuation">.</span>md
├── docs <span class="token comment">// 使用文档</span>
│   └── rules <span class="token comment">// 所有规则的文档</span>
│       └── settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number<span class="token punctuation">.</span>md <span class="token comment">// 具体规则文档</span>
├── lib <span class="token comment">// eslint 规则开发</span>
│   ├── index<span class="token punctuation">.</span>js 引入<span class="token operator">+</span>导出rules文件夹的规则
│   └── rules <span class="token comment">// 此目录下可以构建多个规则</span>
│       └── settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number<span class="token punctuation">.</span>js <span class="token comment">// 规则细节</span>
├── <span class="token keyword">package</span><span class="token punctuation">.</span>json
└── tests <span class="token comment">// 单元测试</span>
    └── lib
        └── rules
            └── settimeout<span class="token operator">-</span>no<span class="token operator">-</span>number<span class="token punctuation">.</span>js <span class="token comment">// 测试该规则的文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_4-安装项目依赖"><a href="#_4-安装项目依赖" aria-hidden="true" class="header-anchor">#</a> 4. 安装项目依赖</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><hr> <p>以上是开发ESLint插件具体规则的准备工作，下面先来看看AST和ESLint原理的相关知识，为我们开发ESLint <code>rule</code> 打一下基础。</p> <h3 id="ast——抽象语法树"><a href="#ast——抽象语法树" aria-hidden="true" class="header-anchor">#</a> AST——抽象语法树</h3> <p>AST是: <code>Abstract Syntax Tree</code>的简称，中文叫做：抽象语法树。</p> <h4 id="ast的作用"><a href="#ast的作用" aria-hidden="true" class="header-anchor">#</a> AST的作用</h4> <p>将代码抽象成树状数据结构，方便后续分析检测代码。</p> <h4 id="代码被解析成ast的样子"><a href="#代码被解析成ast的样子" aria-hidden="true" class="header-anchor">#</a> 代码被解析成AST的样子</h4> <p><a href="https://astexplorer.net/" target="_blank" rel="noopener noreferrer">astexplorer.net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>是一个工具网站：它能查看代码被解析成AST的样子。</p> <p>如下图：<strong>在右侧选中一个值时，左侧对应区域也变成高亮区域，这样可以在AST中很方便的选中对应的代码</strong>。</p> <h4 id="ast-选择器："><a href="#ast-选择器：" aria-hidden="true" class="header-anchor">#</a> AST 选择器：</h4> <p>下图中被圈起来的部分，称为AST selectors(选择器)。</p> <p><strong>AST 选择器的作用</strong>：使用代码通过选择器来选中特定的代码片段，然后再对代码进行静态分析。</p> <p>AST 选择器很多，ESLint官方专门有一个仓库列出了所有类型的选择器: <a href="https://github.com/estree/estree" target="_blank" rel="noopener noreferrer">estree<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>下文中开发ESLint <code>rule</code>就需要用到选择器，等下用到了就懂了，现在知道一下就好了。</p> <p><img src="https://github.com/OBKoro1/articleImg_src/blob/master/2019/2019_11_19_AST.png?raw=true" alt="将代码解析成AST"></p> <hr> <h3 id="eslint的运行原理"><a href="#eslint的运行原理" aria-hidden="true" class="header-anchor">#</a> ESLint的运行原理</h3> <p>在开发规则之前，我们需要ESLint是怎么运行的，了解插件为什么需要这么写。</p> <h3 id="_1-将代码解析成ast"><a href="#_1-将代码解析成ast" aria-hidden="true" class="header-anchor">#</a> 1. 将代码解析成AST</h3> <p>ESLint使用JavaScript解析器<a href="https://github.com/eslint/espree" target="_blank" rel="noopener noreferrer">Espree<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>把JS代码解析成AST。</p> <p>PS：解析器：是将代码解析成AST的工具，ES6、react、vue都开发了对应的解析器所以ESLint能检测它们的，ESLint也是因此一统前端Lint工具的。</p> <h3 id="_2-深度遍历ast，监听匹配过程。"><a href="#_2-深度遍历ast，监听匹配过程。" aria-hidden="true" class="header-anchor">#</a> 2. 深度遍历AST，监听匹配过程。</h3> <p>在拿到AST之后，ESLint会以&quot;从上至下&quot;再&quot;从下至上&quot;的顺序遍历每个选择器两次。</p> <h4 id="_3-触发监听选择器的rule回调"><a href="#_3-触发监听选择器的rule回调" aria-hidden="true" class="header-anchor">#</a> 3. 触发监听选择器的<code>rule</code>回调</h4> <p>在深度遍历的过程中，生效的每条规则都会对其中的某一个或多个选择器进行监听，每当匹配到选择器，监听该选择器的rule，都会触发对应的回调。</p> <h4 id="_4-具体的检测规则等细节内容。"><a href="#_4-具体的检测规则等细节内容。" aria-hidden="true" class="header-anchor">#</a> 4. 具体的检测规则等细节内容。</h4> <hr> <h2 id="开发规则"><a href="#开发规则" aria-hidden="true" class="header-anchor">#</a> 开发规则</h2> <h3 id="规则默认模板"><a href="#规则默认模板" aria-hidden="true" class="header-anchor">#</a> 规则默认模板</h3> <p>打开<code>rule</code>生成的模板文件<code>lib/rules/settimeout-no-number.js</code>, 清理一下文件，删掉不必要的选项：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        docs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            description<span class="token punctuation">:</span> <span class="token string">&quot;setTimeout 第二个参数禁止是数字&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        fixable<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>  <span class="token comment">// 修复函数</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token comment">// rule 核心</span>
    create<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// 公共变量和函数应该在此定义</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token comment">// 返回事件钩子</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>删掉的配置项，有些是ESLint官方核心规则才是用到的配置项，有些是暂时不必了解的配置，需要用到的时候，可以自行查阅<a href="https://cn.eslint.org/docs/developer-guide/working-with-rules" target="_blank" rel="noopener noreferrer">ESLint 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="create方法-监听选择器"><a href="#create方法-监听选择器" aria-hidden="true" class="header-anchor">#</a> create方法-监听选择器</h3> <blockquote><p>上文ESLint原理第三部中提到的：在深度遍历的过程中，生效的每条规则都会对其中的某一个或多个选择器进行监听，每当匹配到选择器，监听该选择器的rule，都会触发对应的回调。</p></blockquote> <p><code>create</code>返回一个对象，对象的属性设为选择器，ESLint会收集这些选择器，在AST遍历过程中会执行所有监听该选择器的回调。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// rule 核心</span>
create<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 公共变量和函数应该在此定义</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token comment">// 返回事件钩子</span>
        Identifier<span class="token punctuation">:</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// node是选中的内容，是我们监听的部分, 它的值参考AST</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="观察ast："><a href="#观察ast：" aria-hidden="true" class="header-anchor">#</a> 观察AST：</h3> <p>创建一个ESLint <code>rule</code>需要观察代码解析成AST，选中你要检测的代码，然后进行一些判断。</p> <p>以下代码都是通过<a href="https://astexplorer.net/" target="_blank" rel="noopener noreferrer">astexplorer.net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>在线解析的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'settimeout'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://github.com/OBKoro1/articleImg_src/blob/master/2019/AST_setTimeout.png?raw=true" alt="setTimeout第二个参数为数字时的AST"></p> <h3 id="rule完整文件"><a href="#rule完整文件" aria-hidden="true" class="header-anchor">#</a> rule完整文件</h3> <p><code>lib/rules/settimeout-no-number.js</code>:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        docs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            description<span class="token punctuation">:</span> <span class="token string">&quot;setTimeout 第二个参数禁止是数字&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        fixable<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>  <span class="token comment">// 修复函数</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// rule 核心</span>
    create<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 公共变量和函数应该在此定义</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token comment">// 返回事件钩子</span>
            <span class="token string">'CallExpression'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">!==</span> <span class="token string">'setTimeout'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">// 不是定时器即过滤</span>
                <span class="token keyword">const</span> timeNode <span class="token operator">=</span> node<span class="token punctuation">.</span>arguments <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment">// 获取第二个参数</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeNode<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">// 没有第二个参数</span>
                <span class="token comment">// 检测报错第二个参数是数字 报错</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>timeNode<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'Literal'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> timeNode<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    context<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        node<span class="token punctuation">,</span>
                        message<span class="token punctuation">:</span> <span class="token string">'setTimeout第二个参数禁止是数字'</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>context.report()：这个方法是用来通知ESLint这段代码是警告或错误的，用法如上。在<a href="https://cn.eslint.org/docs/developer-guide/working-with-rules#the-context-object" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>查看<code>context</code>和<code>context.report()</code>的文档。</p> <p>规则写完了，<strong>原理就是依据<code>AST</code>解析的结果，做针对性的检测，过滤出我们要选中的代码，然后对代码的值进行逻辑判断</strong>。</p> <p>可能现在会有点懵逼，但是不要紧，我们来写一下测试用例，然后用<code>debugger</code>来看一下代码是怎么运行的。</p> <h3 id="测试用例："><a href="#测试用例：" aria-hidden="true" class="header-anchor">#</a> 测试用例：</h3> <p>测试文件<code>tests/lib/rules/settimeout-no-number.js</code>:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * @fileoverview setTimeout 第二个参数禁止是数字
 * @author OBKoro1
 */</span>
<span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> rule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../../../lib/rules/settimeout-no-number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 引入rule</span>
    RuleTester <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;eslint&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>RuleTester<span class="token punctuation">;</span>

<span class="token keyword">var</span> ruleTester <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuleTester</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    parserOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        ecmaVersion<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token comment">// 默认支持语法为es5 </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 运行测试用例</span>
ruleTester<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">&quot;settimeout-no-number&quot;</span><span class="token punctuation">,</span> rule<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// 正确的测试用例</span>
    valid<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            code<span class="token punctuation">:</span> <span class="token string">'let someNumber = 1000; setTimeout(()=&gt;{ console.log(11) },someNumber)'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            code<span class="token punctuation">:</span> <span class="token string">'setTimeout(()=&gt;{ console.log(11) },someNumber)'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 错误的测试用例</span>
    invalid<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            code<span class="token punctuation">:</span> <span class="token string">'setTimeout(()=&gt;{ console.log(11) },1000)'</span><span class="token punctuation">,</span>
            errors<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                message<span class="token punctuation">:</span> <span class="token string">&quot;setTimeout第二个参数禁止是数字&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 与rule抛出的错误保持一致</span>
                type<span class="token punctuation">:</span> <span class="token string">&quot;CallExpression&quot;</span> <span class="token comment">// rule监听的对应钩子</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>下面来学习一下怎么在VSCode中调试node文件，用于观察<code>rule</code>是怎么运行的。</p> <p>实际上打<code>console</code>的形式，也是可以的，但是在调试的时候打console实在是有点慢，对于node这种节点来说，信息也不全，所以我还是比较推荐通过<code>debugger</code>的方式来调试<code>rule</code>。</p> <h3 id="在vscode中调试node文件"><a href="#在vscode中调试node文件" aria-hidden="true" class="header-anchor">#</a> 在VSCode中调试node文件</h3> <ol><li>点击下图中的设置按钮, 将会打开一个文件<code>launch.json</code></li> <li>在文件中填入如下内容，用于调试node文件。</li> <li>在<code>rule</code>文件中打<code>debugger</code>或者在代码行数那里点一下小红点。</li> <li>点击图中的开始按钮，进入<code>debugger</code></li></ol> <p><img src="https://github.com/OBKoro1/articleImg_src/blob/master/2019/vscode_set.jpg?raw=true" alt="vscode 设置"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token comment">// 使用 IntelliSense 了解相关属性。 </span>
    <span class="token comment">// 悬停以查看现有属性的描述。</span>
    <span class="token comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token string">&quot;version&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;0.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;configurations&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;request&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;launch&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;启动程序&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 调试界面的名称</span>
            <span class="token comment">// 运行项目下的这个文件：</span>
            <span class="token string">&quot;program&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;${workspaceFolder}/tests/lib/rules/settimeout-no-number.js&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;args&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// node 文件的参数</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 下面是用于调试package.json的命令 之前可以用，貌似vscode出了点bug导致现在用不了了</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Launch via NPM&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;request&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;launch&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;runtimeExecutable&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;npm&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;runtimeArgs&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;run-script&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dev&quot;</span>    <span class="token comment">//这里的dev就对应package.json中的scripts中的dev</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;port&quot;</span><span class="token punctuation">:</span> <span class="token number">9229</span>    <span class="token comment">//这个端口是调试的端口，不是项目启动的端口</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="运行测试用例进入断点"><a href="#运行测试用例进入断点" aria-hidden="true" class="header-anchor">#</a> 运行测试用例进入断点</h3> <ol><li>在<code>lib/rules/settimeout-no-number.js</code>中打一些<code>debugger</code></li> <li>点击开始按钮，以调试的形式运行测试文件<code>tests/lib/rules/settimeout-no-number.js</code></li> <li>开始调试<code>rule</code>。</li></ol> <hr> <h3 id="发布插件"><a href="#发布插件" aria-hidden="true" class="header-anchor">#</a> 发布插件</h3> <p>eslint插件都是以<code>npm</code>包的形式来引用的，所以需要把插件发布一下：</p> <ol><li><p>注册：如果你还未注册npm账号的话，需要去<a href="https://www.npmjs.com/signup" target="_blank" rel="noopener noreferrer">注册<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>一下。</p></li> <li><p>登录npm: <code>npm login</code></p></li> <li><p>发布<code>npm</code>包: <code>npm publish</code>即可，ESLint已经把<code>package.json</code>弄好了。</p></li></ol> <h3 id="集成到项目"><a href="#集成到项目" aria-hidden="true" class="header-anchor">#</a> 集成到项目:</h3> <p>安装<code>npm</code>包：<code>npm i eslint-plugin-korolint -D</code></p> <ol><li>常规的方法: <code>引入插件一条条写入规则</code></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'korolint'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">{</span> 
    <span class="token string">&quot;korolint/settimeout-no-number&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;error&quot;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="2"><li><code>extends</code>继承插件配置：</li></ol> <p>当规则比较多的时候，用户一条条去写，未免也太麻烦了，所以ESLint可以<a href="https://cn.eslint.org/docs/developer-guide/working-with-plugins#configs-in-plugins" target="_blank" rel="noopener noreferrer">继承插件的配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：</p> <p>修改一下<code>lib/rules/index.js</code>文件:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> requireIndex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'requireindex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token function">requireIndex</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/rules'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 导出所有规则</span>
  configs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 导出自定义规则 在项目中直接引用</span>
    koroRule<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'korolint'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 引入插件</span>
      rules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 开启规则</span>
        <span class="token string">'korolint/settimeout-no-number'</span><span class="token punctuation">:</span> <span class="token string">'error'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> output<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>使用方法：</p> <p>使用<code>extends</code>来继承插件的配置，<code>extends</code>不止这种继承方式，即使你传入一个npm包，一个文件的相对路径地址，eslint也能继承其中的配置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'plugin:korolint/koroRule'</span> <span class="token punctuation">]</span> <span class="token comment">// 继承插件导出的配置</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>PS : 这种使用方式, npm的包名不能为<code>eslint-plugin-xx-xx</code>,只能为<code>eslint-plugin-xx</code>否则会有报错，被这个问题搞得头疼o(╥﹏╥)o</p> <h2 id="扩展："><a href="#扩展：" aria-hidden="true" class="header-anchor">#</a> 扩展：</h2> <p>以上内容足够开发一个插件，这里是一些扩展知识点。</p> <h3 id="遍历方向："><a href="#遍历方向：" aria-hidden="true" class="header-anchor">#</a> 遍历方向：</h3> <p>上文中说过: 在拿到AST之后，ESLint会以&quot;从上至下&quot;再&quot;从下至上&quot;的顺序遍历每个选择器两次。</p> <p>我们所监听的<strong>选择器默认会在&quot;从上至下&quot;的过程中触发，如果需要在&quot;从下至上&quot;的过程中执行则需要添加<code>:exit</code></strong>，在上文中<code>CallExpression</code>就变为<code>CallExpression:exit</code>。</p> <p><strong>注意</strong>：一段代码解析后可能包含多次同一个选择器，选择器的钩子也会多次触发。</p> <h3 id="fix函数：自动修复rule错误"><a href="#fix函数：自动修复rule错误" aria-hidden="true" class="header-anchor">#</a> fix函数：自动修复rule错误</h3> <p><strong>修复效果</strong>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 修复前</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token comment">// 修复后 变量名故意写错 为了让用户去修改它</span>
<span class="token keyword">const</span> countNumber1 <span class="token operator">=</span> <span class="token number">1000</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span> countNumber2<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol><li>在rule的meta对象上打开修复功能:</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// rule文件</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  meta<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    docs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      description<span class="token punctuation">:</span> <span class="token string">'setTimeout 第二个参数禁止是数字'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    fixable<span class="token punctuation">:</span> <span class="token string">'code'</span> <span class="token comment">// 打开修复功能</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>在<code>context.report()</code>上提供一个<code>fix</code>函数:</li></ol> <p>把上文的<code>context.report</code>修改一下，增加一个<code>fix</code>方法即可，更详细的介绍可以看一下<a href="https://cn.eslint.org/docs/developer-guide/working-with-rules#applying-fixes" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>context<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    node<span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">'setTimeout第二个参数禁止是数字'</span><span class="token punctuation">,</span>
    <span class="token function">fix</span><span class="token punctuation">(</span>fixer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> numberValue <span class="token operator">=</span> timeNode<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">const</span> statementString <span class="token operator">=</span> <span class="token template-string"><span class="token string">`const countNumber = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>numberValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token comment">// 修改数字为变量</span>
        fixer<span class="token punctuation">.</span><span class="token function">replaceTextRange</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>range<span class="token punctuation">,</span> <span class="token string">'countNumber'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// 在setTimeout之前增加一行声明变量的代码 用户自行修改变量名</span>
        fixer<span class="token punctuation">.</span><span class="token function">insertTextBeforeRange</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>range<span class="token punctuation">,</span> statementString<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="项目地址"><a href="#项目地址" aria-hidden="true" class="header-anchor">#</a> 项目地址:</h3> <p><a href="https://github.com/OBKoro1/eslint-plugin-korolint" target="_blank" rel="noopener noreferrer">eslint-plugin-korolint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <hr> <p>呼~ 这篇博客断断续续，写了好几周，终于完成了！</p> <p>大家有看到这篇博客的话，建议跟着博客的一起动手写一下，动手实操一下比你mark一百篇文章都来的有用，花不了很长时间的，希望各位看完本文，都能够更深入的了解到ESLint的运行原理。</p> <h4 id="觉得我的博客对你有帮助的话，就关注一下-点个赞吧！"><a href="#觉得我的博客对你有帮助的话，就关注一下-点个赞吧！" aria-hidden="true" class="header-anchor">#</a> 觉得我的博客对你有帮助的话，就关注一下/点个赞吧！</h4> <p><a href="http://obkoro1.com/web_accumulate/" target="_blank" rel="noopener noreferrer">前端进阶积累<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、<a href="https://user-gold-cdn.xitu.io/2018/5/1/1631b6f52f7e7015?w=344&h=344&f=jpeg&s=8317" target="_blank" rel="noopener noreferrer">公众号<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、<a href="https://github.com/OBKoro1" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、wx:OBkoro1、邮箱：obkoro1@foxmail.com</p> <h4 id="基友带我飞"><a href="#基友带我飞" aria-hidden="true" class="header-anchor">#</a> 基友带我飞</h4> <p>ESLint插件是向基友<a href="https://juejin.im/user/5ba9f38ce51d450e8477bd7a/posts" target="_blank" rel="noopener noreferrer">yeyan1996<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>学习的，在遇到问题的时候，也是他指点我的，特此感谢。</p> <p>参考资料：</p> <p><a href="https://cn.eslint.org/docs/developer-guide/working-with-rules" target="_blank" rel="noopener noreferrer">创建规则<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://zhuanlan.zhihu.com/p/53680918" target="_blank" rel="noopener noreferrer">ESLint 工作原理探讨<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="点个star支持我一下"><a href="#点个star支持我一下" aria-hidden="true" class="header-anchor">#</a> 点个<a href="https://github.com/OBKoro1/web_accumulate" target="_blank" rel="noopener noreferrer">Star<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>支持我一下~</h3> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/OBKoro1/web_accumulate/edit/master/docs/accumulate/tool/ESLint插件.md" target="_blank" rel="noopener noreferrer">帮助我改善这个页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">12/8/2019, 3:50:54 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/web_accumulate/assets/js/app.5a5b14ca.js" defer></script><script src="/web_accumulate/assets/js/37.f9716a71.js" defer></script><script src="/web_accumulate/assets/js/2.58d0c891.js" defer></script>
  </body>
</html>
